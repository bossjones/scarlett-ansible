# file: bossjones.common/tasks/bootstrap.yml
---

- name: Read the bootstrap variables
  include_vars: "bootstrap.yml"

- name: update system locales
  copy: src=etc/profile.d/locales.sh
        dest=/etc/profile.d/locales.sh
        mode=0755
        owner=root
        group=root

- name: Disable multiarch support for ubuntu 14.04
  command: dpkg --remove-architecture i386

- name: Install aptitude packages via apt
  apt: pkg={{ item }} state=present
  with_items:
  - aptitude
  sudo: yes

- name: Run Aptitude Upgrade
  apt: update_cache=yes force=yes upgrade=yes

- name: install kernel headers
  apt: pkg=linux-headers-{{ ansible_kernel }}

- name: Make sure the server_packages packages are installed (Debian)
  apt:
    name: "{{item}}"
    state: latest
  with_items: server_packages
  sudo: yes

- name: reconfigure locales
  command: dpkg-reconfigure locales

- name: Make sure the general_prereqs packages are installed (Debian)
  apt:
    name: "{{item}}"
    state: latest
  with_items: general_prereqs
  sudo: yes

- name: Make sure the openssh_packages packages are installed (Debian)
  apt:
    name: "{{item}}"
    state: latest
  with_items: openssh_packages
  sudo: yes

- name: Make sure the general_prereqs packages are installed (Debian)
  apt:
    name: "{{item}}"
    state: latest
  with_items: general_prereqs
  sudo: yes

- name: Make sure the python_prereqs packages are installed (Debian)
  apt:
    name: "{{item}}"
    state: latest
  with_items: python_prereqs
  sudo: yes

- name: Add git-core repo PPA
  apt_repository: repo='ppa:git-core/ppa' state=present update_cache=yes
  sudo: yes

- name: Install git packages via apt
  apt: pkg={{ item }} state=latest
  with_items:
  - git
  sudo: yes
